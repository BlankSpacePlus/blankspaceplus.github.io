---
title: 结构体与类
date: 2023-03-26 02:06:43
summary: 本文从数据封装入手，以C++为例，讨论结构体与类的语法规则和区别。
tags:
- 程序设计
categories:
- 程序设计
---

# 数据封装

数据封装是面向对象编程中的一个重要概念，但其真实含义却不仅局限于面向对象。博主在面向对象的软件工程系列文章中介绍过[封装、继承、多态](https://blankspace.blog.csdn.net/article/details/114697596)。本文中，我们试着从编程宏观理解数据封装。

数据封装是一种将数据和实现细节隐藏起来的编程技术，它可以在不暴露实现细节的情况下，提供对数据的访问和操作。数据封装通常用于构建抽象数据类型（Abstract Data Types，ADT），是一种将数据和操作封装为一个整体的编程方式。

在数据封装中，数据被视为一个黑盒子，只能通过预定义的接口来进行访问和操作。这些接口可以是函数、方法、访问器等，通过这些接口，用户可以访问和操作数据，但无法直接访问数据的实现细节。

数据封装的目的是将数据和实现细节隐藏起来，以提高代码的可维护性和可重用性。通过隐藏实现细节，我们可以避免用户直接访问数据，从而保证数据的安全性和一致性。同时，我们也可以更轻松地对数据的实现细节进行修改，而不必担心影响用户代码的正确性。

在一些编程语言中，如C++和Java，数据封装是通过访问控制关键字（如public、private、protected）来实现的。这些关键字可以控制类的成员变量和方法的访问权限，从而实现数据封装。在其他编程语言中，如Python和Ruby，数据封装通常是通过命名约定来实现的，即将类的私有成员变量命名为以双下划线开头的变量，以表示它们是私有的。

总之，数据封装是一种将数据和实现细节隐藏起来的编程技术，它可以提高代码的可维护性和可重用性，同时保证数据的安全性和一致性。无论是面向对象编程还是其他编程范式，数据封装都是一种非常重要的概念。

# 结构体与类

## 结构体的基本语法

1. **类的定义**。C++类的定义包括类名、数据成员和成员函数。
    ```cpp
    class ClassName {
        private:
            // 私有成员变量声明
        public:
            // 公有成员函数声明
    };
    ```
2. **访问控制**。C++中的类可以使用public、private和protected三种访问控制关键字控制成员变量和成员函数的访问权限。这些关键字可以在类的定义中使用。它们的作用如下：
    - public：公有成员，可以在类的外部和内部被访问。
    - private：私有成员，只能在类的内部被访问，外部无法访问。
    - protected：保护成员，只能在类的内部和派生类中被访问，外部无法访问。
3. **成员变量**。成员变量是类中存储数据的变量。它们可以被定义为public、private或protected类型。
    ```cpp
    class ClassName {
        private:
            int privateMember; // 私有成员变量
        public:
            int publicMember; // 公有成员变量
            void setPrivateMember(int x) {
                privateMember = x;
            }
    };
    ```
4. **成员函数**。成员函数是类中定义的函数，可以访问类中的成员变量。成员函数也可以被定义为public、private或protected类型。
    ```cpp
    class ClassName {
        private:
            int privateMember; // 私有成员变量
        public:
            void publicFunction() {
                // 公有成员函数
            }
        private:
            void privateFunction() {
                // 私有成员函数
            }
    };
    ```
5. **构造函数和析构函数**。构造函数是一种特殊的成员函数，它在类的对象创建时自动调用，并用于初始化对象的成员变量。析构函数也是一种特殊的成员函数，它在对象销毁时自动调用，并用于清理对象分配的资源。
    ```cpp
    class ClassName {
        public:
            ClassName() { // 构造函数
                // 构造函数代码
            }
            ~ClassName() { // 析构函数
                // 析构函数代码
            }
    };
    ```
6. **对象的创建和销毁**。`ClassName objectName;`可以创建对象，对象创建时会自动调用构造函数进行初始化。使用delete关键字可以销毁对象，销毁时会自动调用析构函数进行清理。

## 类的基本语法

1. **结构体的定义**。结构体的定义使用struct关键字。
    ```cpp
    struct structName {
        dataType memberName1;
        dataType memberName2;
        // ...
    } objectName;
    ```
    其中，structName是结构体名称，dataType是成员变量的数据类型，memberName是成员变量的名称，可以定义多个成员变量。
2. **成员变量**。结构体中的成员变量可以是各种数据类型，例如int、float、char、double、bool等等。成员变量可以被直接访问和修改。
    ```cpp
    struct Person {
        string name;
        int age;
    } p;

    p.name = "Tom";
    p.age = 20;
    ```
3. **结构体数组**。可以创建结构体数组，使用方法和普通数组相同。
    ```cpp
    Person persons[3];
    persons[0].name = "Tom";
    persons[0].age = 20;
    // ...
    ```
4. **构造函数**。结构体可以有自己的构造函数，用于初始化成员变量。构造函数还可以接受参数。
    ```cpp
    struct Person {
        string name;
        int age;
        Person(string n, int a) {
            name = n;
            age = a;
        }
    } p("Tom", 20);
    ```
    这里定义了一个Person结构体，并定义了一个构造函数，用于初始化成员变量name和age。在创建对象时，可以直接传入参数进行初始化。
5. **结构体指针**。结构体指针可以指向结构体，使用方法与普通指针相同。
    ```cpp
    Person *p = new Person("Tom", 20);
    ```
    这里创建了一个Person结构体指针，并使用new运算符在堆上创建了一个Person对象。可以通过指针访问和修改对象的成员变量。

## 结构体与类的对比

结构体和类都是用于封装数据的编程概念，但它们在很多方面有所不同。下面以C++为例，比较结构体和类：
- 成员变量的默认访问级别：在C++中，结构体的成员变量默认是public的，而类的成员变量默认是private的。
- 成员函数：类可以定义成员函数（也称为方法），而结构体不能。成员函数可以访问类的成员变量，并且可以对它们进行操作。
- 继承和多态性：类可以使用继承和多态性的概念，而结构体不支持这些概念。
- 实例化：类必须实例化才能使用它的成员函数和变量，而结构体可以直接使用它的成员变量。
- 内存分配：在C++中，结构体和类的内存分配方式是相同的。
- 用途：结构体通常用于存储一组相关的数据，如坐标、颜色等。类则更多地用于封装数据和行为，并将它们作为一个整体来操作，如人、汽车等。
- 对象和实例：类实例化后得到的对象可以调用类中定义的方法，而结构体没有对象的概念。

综上所述，结构体和类在许多方面都有所不同。结构体更适合简单的数据类型的存储，而类则更适合封装数据和行为，并将它们作为一个整体来操作。开发人员需要根据实际需求选择适合的数据结构。
