---
title: 语法糖
date: 2023-05-01 19:44:46
summary: 本文分享一些对语法糖的理解思考。
tags:
- 程序设计
categories:
- 程序设计
---

# 语法糖

语法糖（Syntactic Sugar）由 Peter J. Landin 于1964提出，是指在计算机语言中，某种语法的实现并不影响计算机的功能和表达能力，但使代码更加易读易写，从而方便程序员使用的一种语言特性。

通俗来说，语法糖就是一些看起来很甜美的语法，它们致力于让编程变得更加轻松，让程序员可以用更少的代码完成同样的功能。

有了语法糖的简化，程序员可以选择是使用较短的形式还是较长的形式，但通常会使用较短的形式，因为它更短且更易读易写。

语言处理器，包括编译器和静态分析器，通常在处理之前将加糖结构扩展为更冗长的等价物，这个过程有时称为“脱糖”。

# 语法糖与AST

## AST

AST（Abstract Syntax Tree，抽象语法树）是一种基于树形结构的程序表示方式，它是源代码在编译器中的中间表示形式，能够在语法和语义上解析源代码，并在编译过程中进行优化。AST通常用于编译器、静态分析工具、自动化重构工具等领域。

AST是源代码的抽象表示，它通过将源代码转化为语法上更简单的树形结构，使得编译器可以更加高效地分析和处理源代码。AST包含了语法树中的所有信息，包括代码中的每个标识符、操作符、关键字以及它们之间的关系。AST还可以通过在树的节点上存储有关代码的类型、位置、范围、语义等额外信息，以支持更复杂的语言特性和分析。

在Java中，AST通常由词法分析器和语法分析器生成。词法分析器将源代码分解成基本单元token，如标识符、操作符、关键字等，然后将这些单元传递给语法分析器，语法分析器将这些单元组成树形结构，并生成AST。

在使用AST时，可以通过遍历树形结构来获取代码中的信息，并进行相应的处理和分析。AST还可以通过修改节点来进行代码重构、优化和转换等操作，从而提高代码质量和可维护性。常用的Java AST工具包括Eclipse JDT、ANTLR等。

## 语法糖与AST

作为编程语言中的构造，如果该构造可以从语言中删除而不影响此语言的功能，即语言的功能和表达能力将保持不变，那么该构造就可以称为该语言的语法糖。

由此不难看出，语法糖体现了用AST编写程序和用实际源代码编写程序之间的区别。

# 语法糖的不同层次

广义上，编程语言的一切语法最终都是语法糖。博主认为，对语法糖的判断与其所在抽象层次有关。

推荐阅读：[编程语言的抽象层次](https://blankspace.blog.csdn.net/article/details/102681129)

相较于机器语言代码指示逻辑单元排列的存储程序，汇编语言自动计算代码偏移地址的功能就是语法糖。

更高抽象层次的结构化编程语言带来了比汇编语言更规范的语法糖，例如一些控制结构成为汇编程序中最常见的模式以避免意大利面条代码。

以Java为例，Java中最常用的语法糖主要有泛型、自动拆装箱、变长参数、枚举、内部类、增强for循环、try-with-resources语法、lambda表达式等。

```java
int[] array = {1, 2, 3, 4, 5};
for (int i : array) {
    System.out.println(i);
}
```

# 语法糖的利弊

前文提到，语法糖使代码更加易读易写，从而方便程序员使用编程语言开发应用程序。Java等编程语言也在不断地被“加糖”，结合智能化IDE的发展，开发者的开发效率得到进一步提升。

然而，一些开发者认为这些语法可用性特性要么不重要，要么完全无意义。值得注意的是，特殊的句法形式使语言不那么统一，其规范更加复杂，并且随着程序变得越来越大和复杂，可能会导致问题。正如“语法糖精”一词，它通常用于描述多余或无益的语法糖变化。

从软件工程实践来看，语法糖的不断扩充可能会降低软件系统代码的可维护性，编码规范是否要不断向新增语法糖“妥协”也是值得思考的问题。

# 语法盐

语法糖对开发者无疑是“甜美的”。语法盐则与此相对，表示一种旨在使编写错误代码变得更难的功能。

语法盐通常意味着更严格的语法规范（编译时错误），而语法盐的替代方法是为可能出错的代码片段生成编译器警告。

语法加盐也可能会提高代码的长度，但可能会改善程序的健壮性。
