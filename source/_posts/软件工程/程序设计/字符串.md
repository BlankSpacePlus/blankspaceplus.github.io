---
title: 字符串
date: 2023-03-15 17:10:33
summary: 本文分享字符串的相关内容，以C、C++、Java、Python、JavaScript为例。
tags:
- 程序设计
categories:
- 程序设计
---

# 前置知识

推荐阅读：[变量声明](https://blankspace.blog.csdn.net/article/details/129382715)

# C字符串

C字符串实际上是使用空字符`\0`结尾的一维字符数组。因此，`\0`是用于标记字符串的结束。

空字符又称结束符，是一个char数值为`0`的控制字符。`\0`是转义字符，表明是空字符而非字符0。

C编译器会在初始化数组时，自动把`\0`放在字符串的末尾。如果想要人为调整字符串，可以人为地将`\0`放在字符串的末尾。

字符串的字面量是常量。

## string.h

string.h头文件定义了一个变量类型size_t(本质无符号整数)、一个宏NULL和各种操作字符数组的函数。

| 字符串处理函数 | 说明 |
|:----:|:----:|
| `void *memchr(const void *str, int c, size_t n)` | 在参数 str 所指向的字符串的前 n 个字节中搜索第一次出现字符 c（一个无符号字符）的位置。 |
| `int memcmp(const void *str1, const void *str2, size_t n)` | 把 str1 和 str2 的前 n 个字节进行比较。 |
| `void *memcpy(void *dest, const void *src, size_t n)` | 从 src 复制 n 个字符到 dest。 |
| `void *memmove(void *dest, const void *src, size_t n)` | 另一个用于从 src 复制 n 个字符到 dest 的函数。 |
| `void *memset(void *str, int c, size_t n)` | 复制字符 c（一个无符号字符）到参数 str 所指向的字符串的前 n 个字符。 |
| `char *strcat(char *dest, const char *src)` | 把 src 所指向的字符串追加到 dest 所指向的字符串的结尾。 |
| `char *strncat(char *dest, const char *src, size_t n)` | 把 src 所指向的字符串追加到 dest 所指向的字符串的结尾，直到 n 字符长度为止。 |
| `char *strchr(const char *str, int c)` | 在参数 str 所指向的字符串中搜索第一次出现字符 c（一个无符号字符）的位置。 |
| `int strcmp(const char *str1, const char *str2)` | 把 str1 所指向的字符串和 str2 所指向的字符串进行比较。 |
| `int strncmp(const char *str1, const char *str2, size_t n)` | 把 str1 和 str2 进行比较，最多比较前 n 个字节。 |
| `int strcoll(const char *str1, const char *str2)` | 把 str1 和 str2 进行比较，结果取决于 LC_COLLATE 的位置设置。 |
| `char *strcpy(char *dest, const char *src)` | 把 src 所指向的字符串复制到 dest。 |
| `char *strncpy(char *dest, const char *src, size_t n)` | 把 src 所指向的字符串复制到 dest，最多复制 n 个字符。 |
| `size_t strcspn(const char *str1, const char *str2)` | 检索字符串 str1 开头连续有几个字符都不含字符串 str2 中的字符。 |
| `char *strerror(int errnum)` | 从内部数组中搜索错误号 errnum，并返回一个指向错误消息字符串的指针。 |
| `size_t strlen(const char *str)` | 计算字符串 str 的长度，直到空结束字符，但不包括空结束字符。 |
| `char *strpbrk(const char *str1, const char *str2)` | 检索字符串 str1 中第一个匹配字符串 str2 中字符的字符，不包含空结束字符。<br>也就是说，依次检验字符串 str1 中的字符，当被检验字符在字符串 str2 中也包含时，则停止检验，并返回该字符位置。 |
| `char *strrchr(const char *str, int c)` | 在参数 str 所指向的字符串中搜索最后一次出现字符 c（一个无符号字符）的位置。 |
| `size_t strspn(const char *str1, const char *str2)` | 检索字符串 str1 中第一个不在字符串 str2 中出现的字符下标。 |
| `char *strstr(const char *haystack, const char *needle)` | 在字符串 haystack 中查找第一次出现字符串 needle（不包含空结束字符）的位置。 |
| `char *strtok(char *str, const char *delim)` | 分解字符串 str 为一组字符串，delim 为分隔符。 |
| `size_t strxfrm(char *dest, const char *src, size_t n)` | 根据程序当前的区域选项中的 LC_COLLATE 来转换字符串 src 的前 n 个字符，并把它们放置在字符串 dest 中。 |

# C++字符串

C++标准库提供了string类型，支持上述所有的操作，另外还增加了其他更多的功能。引入方法是`#include <string>`，而`<string.h>`的引入方法是`#include <string.h>`或`#include <cstring>`。

string常用API：
- `append()`：在字符串的末尾添加字符。
- `find()`：在字符串中查找字符串。
- `insert()`：插入字符。
- `length()`：返回字符串的长度。
- `replace()`：替换字符串。
- `substr()`：返回某个子字符串。

值得一提的是，C++支持C的字符串机制，也有string类型，但二者并不同。

# Java字符串

## 转置字符串

基于此定义，完成对字符串string的转置。
```java
String string = "ADFGJINJOOKC";
int length = string.length();
char[] chars0 = string.toCharArray();
```

### 方法1：转置char[]

转置char[]可以新生成一个char[]，正向遍历原char[]，把char数据逆向复制到新char[]中。

```java
char[] chars1 = new char[length];
for (int i = 0; i < length; i++) {
    chars1[i] = chars0[length-i-1];
}
System.out.println(new String(chars1));
```

更好的方法是swap()，两侧向中间交换。
```java
char[] chars7 = chars0;
for (int i = 0; i < length/2; i++) {
    char temp = chars7[i];
    chars7[i] = chars7[length-i-1];
    chars7[length-i-1] = temp;
}
System.out.println(new String(chars7));
```

swap()可以用位运算实现，尽管效率不见得高。
```java
private static void swap(char a, char b) {
    if (a != b) {
        a ^= b;
        b ^= a;
        a ^= b;
    }
}
```

### 方法2：利用StringBuilder的reverse()转置

虽然String没有reverse()，但可以利用String对象生成StringBuilder对象，再reverse()，打印就直接调toString()了，方便简洁。

```java
System.out.println(new StringBuilder(string).reverse());
```

### 方法3：字符倒序拼接

所谓直接拼接，其实就是new一个StringBuilder对象，倒着遍历char[]，把char一个一个append()到StringBuilder对象上。

```java
StringBuilder reverse3 = new StringBuilder();
for (int i = length-1; i >= 0; i--) {
    reverse3.append(chars0[i]);
}
System.out.println(reverse3);
```

获取字符也可以用charAt(i)：
```java
StringBuilder reverse5 = new StringBuilder();
for (int i = length-1; i >= 0; i--) {
    reverse5.append(string.charAt(i));
}
System.out.println(reverse5);
```

### 方法4：字符倒序输出

倒着遍历，直接打印。由于需要大量的I/O，所以慢。

```java
for (int i = length-1; i >= 0; i--) {
    System.out.print(chars0[i]);
}
System.out.println();
```

### 方法5：利用栈结构倒序拼接

栈自然是可以的，LIFO，但单独拿出来而不利用数组的随机访问，大可不必。

```java
Stack<Character> stack = new Stack<>();
for (char c : chars0) {
    stack.push(c);
}
StringBuilder reverse6 = new StringBuilder();
while (!stack.isEmpty()) {
    reverse6.append(stack.pop());
}
System.out.println(reverse6);
```

## 字符串交叉合并

```java
public class MergeStrings {

    private static void insertChars(char[] chars1, char[] chars2, char[] result) {
        for (int i = chars2.length; i < chars1.length; i++) {
            result[chars2.length+i] = chars1[i];
        }
    }


    public static String mergeTwoStrings(String str1, String str2) {
        char[] chars1 = str1.toCharArray(), chars2 = str2.toCharArray();
        char[] result = new char[chars1.length + chars2.length];
        if (chars1.length >= chars2.length) {
            for (int i = 0; i < chars2.length; i++) {
                result[2*i] = chars1[i];
                result[2*i+1] = chars2[i];
            }
            insertChars(chars1, chars2, result);
        } else {
            for (int i = 0; i < chars1.length; i++) {
                result[2*i] = chars1[i];
                result[2*i+1] = chars2[i];
            }
            insertChars(chars2, chars1, result);
        }
        return new String(result);
    }

}
```

## Object转换String

基于此定义，完成对字符串string的转置。

```java
Object obj = ...;    // 可能是任意值，也可能为null
```

Object转换String有三种方法
- <code>String str = (String)obj;</code> ，即使用强转，从父类型Object向下转型为String。
- <code>String str = obj.toString();</code> ，即使用Object一定会存在的toString()方法。
- <code>String str = String.valueOf(obj);</code> ，即使用String类的静态方法，将一个Object类型的变量转成String类型对象。


### 方法1：强制类型转换

由于所有类的共同祖先类都是Object，所以可以尝试从Object向下强制类型转换为String。

```java
String str = (String)obj;
```

如果obj实际上不是String类型的，程序会抛出java.lang.ClassCastException异常。

因此，更妥当的实现是：
```java
if (obj instanceof String) {
    String str = (String)obj;
}
```

### 方法2：利用Object的toString()转换

Object类存在toString()方法，可以直接调用。

```java
String str = obj.toString();
```

如果obj是null，则程序会抛出java.lang.NullPointerException异常。

因此，更妥当的实现是：
```java
if (obj != null) {
    String str = obj.toString();
}
```

### 方法3：利用String的valueOf()转换

String类提供了九个重载方法：
- **String.valueOf(boolean value): String**
- **String.valueOf(char value): String**
- **String.valueOf(char[] data): String**
- **String.valueOf(double value): String**
- **String.valueOf(float value): String**
- **String.valueOf(int value): String**
- **String.valueOf(long value): String**
- **String.valueOf(Object data): String**
- **String.valueOf(char[] data, int start, int length): String**

```java
String str = String.valueOf(obj);
```

查看String.valueOf(Object data)的源码：
```java
public static String valueOf(Object obj) {
    return obj == null ? "null" : obj.toString();
}
```

因此，如果obj是null，程序不会抛出java.lang.NullPointerException异常，而是返回`"null"`，这点要注意。

## int转换String

推荐方案：
```java
int i = 100;
Integer.toString(i);
```

# Python字符串

Python字符串的重要方法如下表所示：

| 字符串处理函数 | 描述 |
|:----:|:----:|
| string.capitalize() | 将字符串第一个字符大写 |
| string.count() | 获得字符串中某一个子字符串的数目 |
| string.find() | 获得字符串中某一个子字符串的起始位置，无则返回-1 |
| string.isalnum() | 检测字符串是否仅包含 0~9 、A~Z 和 a~z |
| string.isalpha() | 检测字符串是否仅包含 A~Z 和 a~z |
| string.isdigit() | 检测字符串是否只包含数字 |
| string.islower() | 检测字符串是否均为小写字母 |
| string.isspace() | 检测字符串中所有字符是否均为空白字符 |
| string.istitle() | 检测字符串中单词是否为首字母大写 |
| string.issuper() | 检测字符串是否均为大写字母 |
| string.join() | 连接字符串 |
| string.lower() | 将字符串全部转换为小写 |
| string.split() | 分割字符串 |
| string.swapcase() | 将字符串中大写字母全部转换为小写，小写字母全部转换为大写 |
| string.title() | 将字符串中的单词首字母大写 |
| string.upper() | 将字符串中全部字母转换为大写 |
| len(string) | 获取字符串长度 |

# JavaScript字符串

JavaScript定义字符串的两种方式：
- `var a = "hello";`
- `var b = new String("hello");`

JavaScript字符串的重要方法如下表所示：

| 方法 | 描述 |
|:----:|:----:|
| `charAt()` | 返回在指定位置的字符。 |
| `charCodeAt()` | 返回在指定的位置的字符的 Unicode 编码。 |
| `concat()` | 连接两个或更多字符串，并返回新的字符串。 |
| `endsWith()` | 判断当前字符串是否是以指定的子字符串结尾的（区分大小写）。 |
| `fromCharCode()` | 将 Unicode 编码转为字符。 |
| `indexOf()` | 返回某个指定的字符串值在字符串中首次出现的位置。 |
| `includes()` | 查找字符串中是否包含指定的子字符串。 |
| `lastIndexOf()` | 从后向前搜索字符串，并从起始位置（0）开始计算返回字符串最后出现的位置。 |
| `match()` | 查找找到一个或多个正则表达式的匹配。 |
| `repeat()` | 复制字符串指定次数，并将它们连接在一起返回。 |
| `replace()` | 在字符串中查找匹配的子串，并替换与正则表达式匹配的子串。 |
| `replaceAll()` | 在字符串中查找匹配的子串，并替换与正则表达式匹配的所有子串。 |
| `search()` | 查找与正则表达式相匹配的值。 |
| `slice()` | 提取字符串的片断，并在新的字符串中返回被提取的部分。 |
| `split()` | 把字符串分割为字符串数组。 |
| `startsWith()` | 查看字符串是否以指定的子字符串开头。 |
| `substr()` | 从起始索引号提取字符串中指定数目的字符。 |
| `substring()` | 提取字符串中两个指定的索引号之间的字符。 |
| `toLowerCase()` | 把字符串转换为小写。 |
| `toUpperCase()` | 把字符串转换为大写。 |
| `trim()` | 去除字符串两边的空白。 |
| `toLocaleLowerCase()` | 根据本地主机的语言环境把字符串转换为小写。 |
| `toLocaleUpperCase()` | 根据本地主机的语言环境把字符串转换为大写。 |
| `valueOf()` | 返回某个字符串对象的原始值。 |
| `toString()` | 返回一个字符串。 |
