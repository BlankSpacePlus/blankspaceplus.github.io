---
title: 变量类型推断
date: 2023-03-09 16:26:06
summary: 本文讨论编程语言的变量类型推断支持，以Java、Python、JavaScript为例。
mathjax: true
tags:
- 程序设计
categories:
- 程序设计
---

# Java类型推断

## 类型判断

Java采用`instanceof`运算符来操作对象实例，检查该对象是否是一个特定类型。

`instanceof`运算符的语法规则：`(<referenceVariable>) instanceof  (<TypeName>)`。

基本类型不是面向对象的一部分。基本类型不能用`.`运算符，不能充当\<referenceVariable\>。

对于以下代码：

```java
public abstract class Shape {

    public abstract int getPerimeter();

}

public class Rectangle extends Shape {

    private int a, b;

    public Rectangle(int a, int b) {
        this.a = a;
        this.b = b;
    }

    @Override
    public int getPerimeter() {
        return this.a + this.b;
    }

}
```

测试代码：
```java
@Test
public void classTypeTest() {
    Shape shape = new Rectangle(2, 3);
    Assertions.assertTrue(shape instanceof Shape);
    Assertions.assertTrue(shape instanceof Rectangle);
}
```

## 类型识别

Java是一门面向对象的语言，java.lang.Object是任意类的基类。以一个命名为`obj`的对象为例，`obj.getClass()`可以获得`obj`对象的类全名。

# Python类型推断

Python程序中，变量往往不明确标明类型(尽管可以)，但可以通过`type()`获取变量的类型。

示例：
- `print(type(1))` $=>$ `<class 'int'>`
- `print(type(1.23))` $=>$ `<class 'float'>`
- `print(type("123"))` $=>$ `<class 'str'>`
- `print(type([1, 2, 3]))` $=>$ `<class 'list'>`
- `print(type((1, 2, 3)))` $=>$ `<class 'tuple'>`
- `print(type({1: 2, 2: 3, 3: 4}))` $=>$ `<class 'dict'>`

此外，还有`isinstance()`函数来判断一个对象是否是一个已知的类型，类似`type()`。

`isinstance()`与`type()`区别：
- `type()`不会认为子类是一种父类类型，不考虑继承关系。
- `isinstance()`会认为子类是一种父类类型，考虑继承关系。

如果要判断两个类型是否相同，推荐使用`isinstance()`。

# JavaScript类型推断

JavaScript提供`typeof`操作符来检测变量的数据类型。typeof可以判断一个变量或者表达式的类型，一般只能返回如下几个结果：number、boolean、string、function、object（NULL、数组、对象）、undefined。

示例：
- `typeof "Sam"` $=>$ `string`
- `typeof 3.14` $=>$ `number`
- `typeof true` $=>$ `boolean`
- `typeof [1,2,3,4,5]` $=>$ `object`
- `typeof {name:'Sam', age:20}` $=>$ `object`

typeof可以判断一个变量是否存在。对于`if(a)`，如果a不存在，则会报错；而对于`if(typeof a!="undefined")`，如果a不存在，也不会报错。

typeof对输入的null、数组、对象时都会输出object类型，所以当我们要判断一个对象是否是数组时或者判断某个变量是否是某个对象的实例则要选择使用`instanceof`。

JavaScript的`instanceof`语法规则是：`var result = <objectName> instanceof <ObjectType>`。
