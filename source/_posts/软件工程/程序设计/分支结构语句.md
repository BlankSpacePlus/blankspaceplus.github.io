---
title: 分支结构语句
date: 2019-05-23 17:07:12
summary: 本文分享选择结构语句的相关内容。
tags:
- 程序设计
categories:
- 程序设计
---

# 选择结构

选择结构是计算机程序设计中的一种基本结构，通常用于根据条件选择性地执行不同的语句或操作。在Java等语言中，选择结构主要通过if语句和switch语句实现。

if语句是最基本的选择结构，语法如下：

```java
if (条件表达式) {
    // 如果条件为真，执行这里的代码块
}
```

其中，条件表达式通常是一个比较表达式，例如a > b或str.equals("hello")等。如果条件为真，则执行if语句后面的代码块；如果条件为假，则跳过整个if语句，继续执行后面的代码。

除了基本的if语句外，还可以使用if-else语句和if-else if-else语句来实现更复杂的条件判断。

if-else语句的语法如下：

```java
if (条件表达式) {
    // 如果条件为真，执行这里的代码块
} else {
    // 如果条件为假，执行这里的代码块
}
```

其中，如果条件表达式为真，则执行if语句后面的代码块；如果条件表达式为假，则执行else语句后面的代码块。

if-else if-else语句则可以用来处理多个条件的情况，语法如下：

```java
if (条件表达式1) {
    // 如果条件1为真，执行这里的代码块
} else if (条件表达式2) {
    // 如果条件2为真，执行这里的代码块
} else if (条件表达式3) {
    // 如果条件3为真，执行这里的代码块
} else {
    // 如果以上条件都不满足，执行这里的代码块
}
```

在if语句中，可以使用逻辑运算符和比较运算符来组合多个条件表达式，例如if (a > b && str.equals("hello"))等。

除了if语句外，Java中还提供了switch语句用于根据多个条件选择性地执行不同的代码块。switch语句的语法如下：

```java
switch (变量表达式) {
    case 常量值1:
        // 如果变量等于常量值1，执行这里的代码块
        break;
    case 常量值2:
        // 如果变量等于常量值2，执行这里的代码块
        break;
    // 可以有多个case语句
    default:
        // 如果变量不等于任何一个常量值，执行这里的代码块
        break;
}
```

在switch语句中，变量表达式通常是一个整数或枚举类型的值，case语句后面的常量值也必须是整数或枚举类型的值。如果变量的值等于某个常量值，则执行对应的case语句后面的代码块；如果变量的值不等于任选择结构还可以嵌套，即在if语句的代码块中嵌套if语句，这样可以实现更复杂的逻辑控制。同时，还有一种特殊的选择结构叫做switch语句，它可以根据不同的条件执行不同的代码块。

switch语句的基本语法为：

```java
switch(expression) {
    case value1:
        // 执行语句块1
        break;
    case value2:
        // 执行语句块2
        break;
    // ...
    default:
        // 执行语句块n
        break;
}
```

其中，expression是一个表达式，value1、value2等是常量值，用来与expression进行比较。如果expression的值等于某个常量值，就会执行该常量值对应的代码块；如果没有匹配的常量值，则执行default对应的代码块。

需要注意的是，每个case语句块末尾需要使用break语句来终止switch语句的执行，否则会继续执行后续的case语句块。另外，expression表达式的数据类型必须与case语句块中常量值的数据类型一致或可以进行隐式转换，否则会编译错误。

选择结构是编程中非常重要的一种控制结构，能够根据不同的条件执行不同的代码块，从而实现复杂的逻辑控制。在实际编程中，需要根据具体需求灵活运用选择结构，以达到预期的控制效果。

以下是使用选择结构时需要注意的几点：
- 条件的判断：在选择结构中，条件判断的准确性和完整性非常重要。需要仔细考虑每种情况的处理方式，并考虑可能出现的特殊情况，以确保程序的正确性和可靠性。
- 语法的正确性：在使用选择结构时，需要保证代码的语法正确性。例如，在使用if语句时，需要保证if和括号之间有一个空格，括号内的条件表达式的语法正确。
- 缩进的规范性：在使用选择结构时，需要注意代码的缩进，以便更清晰地表达程序的逻辑结构。通常，每个代码块应该缩进一个固定的空格数，例如4个空格。
- 可读性的提高：为了提高代码的可读性，在选择结构中，应该使用有意义的变量名和注释，以便程序的使用者更容易理解代码的含义和作用。
- 效率的考虑：在使用选择结构时，还需要考虑代码的效率问题。例如，在使用多个if语句时，应该把出现概率较高的条件放在前面，以便提高程序的执行效率。

# 选择结构的潜在问题

## 单行不加大括号

众所周知，Java的选择结构和循环结构是允许单行不加大括号的。有的资料上会提倡这种模式，因为可以缩减代码的行数；也有的不提倡，认为可能会在后期添加行数很麻烦以及出现意外的错误。

下面略举3例加以阐释：

第一，“空悬”的else引发问题
```java
public class Test1 {
    public static void main(String[] args) {
        int x = 300;
        if (x > 100)
            System.out.println("大于100");
            if (x > 400)
                System.out.println("大于400");
        else
            System.out.println("??");
    }
}
```
你可能会认为这个程序的输出是：
```java
大于100
```

因为会执行外层if不执行内层if，else的缩进对应着外层if...

很遗憾，真实的输出是这样的：

```java
大于100
??
```

这里就涉及到一个“空悬”的else的“归属问题”了。在没有指示的情况下，Java会认为else对应着内层的if，所以就得到了“异常”的输出。

其二，“空悬”的if引发问题

```java
public class Test2 {
    public static void main(String[] args) {
        int x = 200;
        if (x > 100)
            x++;
        else
            x--;
        System.out.println(x);
    }
}
```

这个程序特别简单，输出：

```java
201
```

如果改成：

```java
public class Test2 {
    public static void main(String[] args) {
        int x = 200;
        if (x > 100)
            x++;
            if (x > 300)
                x++;
        else
            x--;
        System.out.println(x);
    }
}
```

输出结果：

```java
200
```

其实就是说else归属于第2个if了，先x++，后x--，就保持了200。

这些问题就是说if后接单行代码，后续维护时没注意产生问题。

其三，打分号但不换行以为还是一行 

```java
public class Test3 {
    public static void main(String[] args) {
        int x = 3;
        if (x > 2)
            if (x > 3)
                x++; x+=2;
        System.out.println(x);
    }
}
```

输出结果：

```java
5
```

这是因为Java以`;`作为语句终结，可能初学者认为自己没换行，实际上这个代码行语句已经结束了。
`x+=2;`语句的条件已经不在if内了，所以会被执行。
