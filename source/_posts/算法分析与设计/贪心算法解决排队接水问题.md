---
title: 贪心算法解决排队接水问题
date: 2020-09-26 21:13:21
summary: 本文基于贪心算法解决排队接水问题（洛谷P1223题），用Java语言描述。
mathjax: true
tags:
- 算法
- Java
categories:
- 算法分析与设计
---

# 题目描述

有 $n$ 个人在一个水龙头前排队接水，假如每个人接水的时间为 $T_i$，请编程找出这 $n$ 个人排队的一种顺序，使得 $n$ 个人的平均等待时间最小。

# 输入格式

第一行为一个整数 $n$。

第二行 $n$ 个整数，第 $i$ 个整数 $T_i$ 表示第 $i$ 个人的等待时间 $T_i$。

# 输出格式

输出文件有两行，第一行为一种平均时间最短的排队顺序；第二行为这种排列方案下的平均等待时间（输出结果精确到小数点后两位）。

# 样例 #1

## 样例输入 #1

```
10 
56 12 1 99 1000 234 33 55 99 812
```

## 样例输出 #1

```
3 2 7 8 1 4 9 6 10 5
291.90
```

# 提示

$n \leq 1000,t_i \leq 10^6$，不保证 $t_i$ 不重复。

当 $t_i$ 重复时，按照输入顺序即可（sort 是可以的）

# 算法分析

龙头只有一个，可以插队接水，目标是总等待接水时间最短。
本题背景类似于操作系统的[进程的SJF调度算法](https://blankspace.blog.csdn.net/article/details/113360821)，可以用贪心算法求解。

SJF算法想要取得进程最少的平均等待时间，就必须优先处理执行时间短的进程。同理，这个问题中，让接水时间最短的人先接水，可以让总的接水等待时间最短，因此平均接水等待时间也最短。

贪心需要先执行自定义排序，两个排序key，第一优先级是time，第二优先级是id。

# Java代码实现

```java
import java.util.Arrays;
import java.util.Comparator;
import java.util.Scanner;

public class Main {

    private static class Person {
        Integer time;
        int id;
        public Person(int time, int id) {
            this.time = time;
            this.id = id;
        }
    }

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        int num = scanner.nextInt();
        Person[] array = new Person[num];
        for (int i = 0; i < num; i++) {
            array[i] = new Person(scanner.nextInt(), i+1);
        }
        scanner.close();
        Arrays.sort(array, Comparator.comparing(person -> person.time));
        long waitingTime = 0, sum = 0;
        StringBuilder result = new StringBuilder();
        for (Person p : array) {
            waitingTime += sum;
            sum += p.time;
            result.append(p.id).append(" ");
        }
        System.out.println(result.toString().trim());
        System.out.printf("%.2f", waitingTime/(double)num);
    }

}
```

# 提交代码

[洛谷 P1223 排队接水](https://www.luogu.com.cn/problem/P1223)
