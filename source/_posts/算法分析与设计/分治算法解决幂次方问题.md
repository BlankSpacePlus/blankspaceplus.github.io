---
title: 分治算法解决幂次方问题
date: 2020-01-24 18:56:16
summary: 本文基于分治算法解决幂次方问题（洛谷P1010题），用Java编程实现。
mathjax: true
tags:
- 算法
- Java
categories:
- 算法分析与设计
---

# 题目描述

任何一个正整数都可以用 $2$ 的幂次方表示。例如 $137=2^7+2^3+2^0$。

同时约定方次用括号来表示，即 $a^b$ 可表示为 $a(b)$。

由此可知，$137$ 可表示为 $2(7)+2(3)+2(0)$

进一步：

$7= 2^2+2+2^0$  ( $2^1$ 用 $2$ 表示)，并且 $3=2+2^0$。

所以最后 $137$ 可表示为 $2(2(2)+2+2(0))+2(2+2(0))+2(0)$。

又如 $1315=2^{10} +2^8 +2^5 +2+1$

所以 $1315$ 最后可表示为 $2(2(2+2(0))+2)+2(2(2+2(0)))+2(2(2)+2(0))+2+2(0)$。

# 输入格式

一行一个正整数 $n$。

# 输出格式

符合约定的 $n$ 的 $0, 2$ 表示（在表示中不能有空格）。

# 样例 #1

## 样例输入 #1

```
1315
```

## 样例输出 #1

```
2(2(2+2(0))+2)+2(2(2+2(0)))+2(2(2)+2(0))+2+2(0)
```

# 提示

**【数据范围】**

对于 $100\%$ 的数据，$1 \le n \le 2 \times {10}^4$。

# 算法分析

二进制数表示的其实就是一个正整数分解成为2的幂次方和。

我们分析一下`x & 1`的作用：
以八位二进制为例：
1 → `00000001`
&是按位析取，所以，我们分析高位是0还是1，结果都是1，所以只看低位。
低位如果是1，即奇数，则结果为00000001，即1，即非0；
低位如果是0，即偶数，则结果为00000000，即0。

所以，得到结论是`x & 1`等价于`x % 2`，但速度更快一些。

再解读一下`x >>= 1`的作用：
`>> 1`指右移1位，由于是正数，所以高位必然补0，相当于`x /= 2`，即自除2。

# Java代码实现

```java
import java.util.Scanner;

public class Main {
    private static String run(int x){
        StringBuilder s = new StringBuilder();
        if(x == 0) {
            return "0";
        }
        int i = 0;
        do {
            if((x & 1) != 0) {
                s.insert(0, ((i == 1) ? "2" : "2(" + run(i) + ")") + ("".equals(s.toString()) ? "" : "+"));
                // 拼接字符串，应题意，要把低次方接在后面
            }
            i++;
            x >>= 1;
        } while(x != 0);// 每次向右移位
        return s.toString();
    }

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(run(scanner.nextInt()));
        scanner.close();
    }
}
```

# 代码提交

[洛谷 P1010 \[NOIP1998 普及组\] 幂次方](https://www.luogu.com.cn/problem/P1010)
