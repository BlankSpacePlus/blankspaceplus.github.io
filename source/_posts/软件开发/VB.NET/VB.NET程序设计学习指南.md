---
title: VB.NET程序设计学习指南
date: 2021-02-01 11:22:47
summary: 本文分享VB.NET程序设计学习指南。
tags:
- VB.NET
categories:
- VB.NET
---

# 疑难解答

## VisualStudio项目开发

1. 我编写完的项目被保存在什么地方了？
答：默认情况下，如果不更改项目的保存路径，项目都会被存放在“我的文档\Visual Studio 2010\Projects”路径下，如果更改过项目存放的位置，那么再次保存其他项目时，它就会被保存在，修改过的位置。

2. 如何打开我以前保存过的项目？
答：要想打开以前的项目可以采用以下的几种方法：
(1) 如果是最近编辑并保存过的项目，可以在“起始页”中的“最近使用的项目”处进行选择，然后单击打开即可。
(2) 在“起始页”中选择“打开项目…”的链接，然后在弹出的对话框中，通过浏览选择所需打开的项目即可。
(3) 通过菜单，“文件”→“打开项目…”来选择所需要打开的项目。
(4) 在文件被保存的位置，如果有扩展名为“sln”的文件，可以通过双击它打开；如果没有，可以找到扩展名是“vbproj”的文件进行双击。

3. 我的“解决方案资源管理器”被不小心关闭了，怎么才能再显示出来？
答：如果在当前的项目中关闭了“解决方案资源管理器”，可以通过菜单选项，或者与之对应的快捷键把它重新打开。具体方法是：在“视图”菜单中，找到“解决方案资源管理器”选项，单击即可，或者使用快捷键“Ctrl+Alt+L”。

4. 我的“代码编辑器”被不小心关闭了，怎么才能重新打开？
答：如果“代码编辑器”被不小心关闭了，可以采用以下方式重新打开它：
（1）在“解决方案资源管理器”中单击“查看代码”工具栏图标。
（2）在“视图”菜单中，选择“代码”菜单项。
（3）直接在键盘上按“F7”键。

5. 属性窗口有什么用呢？
答：属性窗口是在设计过程中对控件设置属性的位置。我们可以通过在属性窗口中选择、或者输入一些值来改变某一具体控件的外观或者状态。我们也可以在选中某一属性的时候，在属性窗口的下方获得关于该属性的简短描述，从而帮助我们理解其含义和用途。

6. 为什么我想修改代码的时候，却不能通过键盘键入任何内容呢？
答：这主要是因为，程序很可能是处于运行状态，只要将窗体关闭，或单击“停止调试”工具栏图标，就可以对代码进行修改了。虽然在运行过程中，我们也可以把窗体最小化，看到代码编辑器中的代码，但是此时是不能修改代码的，只有在程序处于非运行状态下才可以修改代码。

7. 我可以改变“代码编辑器”中显示字体的大小吗？
答：可以的。只要在“工具”菜单下，选择菜单项“选项”，就可以打开一个对话框，在“选项”对话框左侧的“环境”下面看到“字体和颜色”选项，在单击“字体和颜色”后，就可以在右侧对字体的大小进行设置了。字体显示大小的范围是6~24。

8. 如何知道我更新部分的代码是否被保存了？
答：在代码编辑器中编写或修改代码时，代码是否被保存了可以通过代码左侧的竖条颜色进行判断，如果竖条的颜色为绿色，就表示代码已经被保存过了，如果竖条的颜色为黄色，就表示代码没有被保存。如果是加载以前保存过的项目，但并没有修改代码时，绿色和黄色的竖条都不会出现。

9. 如果开发环境的设置不是Visual Basic的，怎样才能创建Visual Basic的项目呢？
答：如果当前的开发环境设置不是Visual Basic的，可以在创建项目时，在“新建项目”对话中的左侧找到“其他语言”中的“Visual Basic”，单击后，右侧的相关模板也会随之变成Visual Basic相关的模板，然后根据需要进行选择模板，之后的步骤就完全一样了。

10. 如何向窗体中添加控件？
答：向窗体中添加控件，可以通过以下两种方式：
(1) 在“工具箱”中双击想要添加到窗体上的控件。这样就会在窗体的默认位置增加一个该控件。
(2) 在“工具箱”中选中想要添加到窗体的控件后，通过拖拽，放到窗体的目标位置上。
需要注意的是，有些控件是不能在运行时显示在窗体上的，所以即使将这类控件拖拽到窗体上，它也不会显示在窗体上，而是显示在窗体外，下面的一块区域中。 

## 基本语法

1. 我要使用的变量应该在什么位置声明？
答：变量的声明位置主要取决于，在设计时确定的变量的作用范围。如果是在整个窗体范围内可用，就可以放在窗体的类框架内，其他方法、属性和事件之外。如果是局部使用的，那么在使用之前声明即可。

2. 怎样在代码中添加注释？
答：添加注释主要有两种方式：
   方式一：以撇号（’）开头，后面加注释的内容。 
   方式二：在方法定义前的空行上输入三个连续的撇号（’），可为方法自动创建注释快。它是Visual Studio 2010内置的XML文档注释功能。 

3. 为什么我的Do While|Until…Loop循环总是处于死循环状态？ 
答：如果需要Do While|Until…Loop循环执行一定次数后退出循环，就需要在循环体内修改循环计数器变量的值。但是DoWhile|Until…Loop循环与For…Next循环不同，它的循环计数器变量的值，并不会自动增加或减少，必须通过编写代码来实现，如果忽略了这个问题，就会导致死循环。

4. 值类型和引用类型有何区别？ 
答：值类型和引用类型的主要区别在于底层的实现方式不同：
值类型表示的是位于堆栈上的简单数据存储，它们的大小都是已知的，所以数据检索的速度相对较快。
引用类型是复杂的类，存储在托管堆上，可以支持不同大小的对象的动态内存分配。

5. 如何进行字符串连接？ 
答：字符串的连接可以使用“&”，也可以使用“+”，但是最好使用“&”进行字符串连接。
因为“+”是Visual Basic的重载运算符，如果在“+”两边不能保证都是字符串的情况下，可能会执行加法操作，从而引发错误。

6. Function过程和Sub过程有何区别？ 
答：Function过程和Sub过程的主要区别在于，Function过程有返回值，而Sub过程没有返回值。
另外就是它们关键字之间的区别，Function过程始于 Function 函数名，终止于End Function；Sub过程始于Sub 过程名，终止于End Sub。

7. 方法调用中参数的按值传递和按引用传递有什么区别？
答：首先，采用的关键字不同，按值传递的关键字为ByVal，这也是默认的参数形式，按引用传递的关键字为ByRef。
第二，按值传递参数时，方法体中的参数名与调用方法时的变量分处不同的作用域，他们之间没有影响，所以形成中值的变化并不会对实参有任何影响；而按引用传递参数时，方法体中使用的参数名实际上就是调用方法时所指定的变量名，因此，方法对形参值所做的任何修改都会影响实参值。 

8. 如何对数组元素进行赋值？ 
答：对数组元素的赋值可以采用以下两种方式： 
方式一：在声明数组的同时进行赋值。这时要求，在声明数组时不能指定数组元素的上限，赋值时，把多个值放置在大括号内，并使用逗号分隔。
例如，在声明整形数组A时并进行赋值：
Dim A() As Integer={1,2,3,4}。 
方式二：先声明数组，并明确数组的长度，然后再为数组元素依次赋值。
例如，先声明可包含4个元素的数组A，然后在依次赋值：
Dim A(3) As Integer A(0)=1 : A(1)=2 : A(2)=3 : A(3)=4

9. 如何循环遍历数组中的元素？ 
答：在对数组中的元素进行遍历时，最好采用For…Next循环，或者 For…Each循环。
如果采用For…Next循环的话，就需要使用GetUpperBound方法获得数组的上限；但是，如果使用For …Each循环的话，系统就会自动确定循环的上限。
例如，对整形数组A中的所有元素进行求和： 
（1）For…Next循环代码如下： 
Dim i As Integer = 0 
Dim Sum As Integer = 0 
For i = 0 To A.GetUpperBound(0) 
Sum += A(i) 
Next 
（2）For…Each循环代码如下： 
Dim i As Integer = 0 
Dim Sum As Integer = 0 
For Each i In A 
Sum += i 
Next 

10. 如果要对数组中的元素进行排序，必须自己编写排序算法吗？ 
答：一般情况下，不需要自己编写排序算法。可以直接调用Array.Sort方法实现排序。
例如，对整形数组A进行升序排序就可以采用语句Array.Sort(A)。 

11. Loop While Until循环与 Do While|Until…Loop循环有什么区别？ 
答：前者循环，在任何条件下都会至少执行一次循环。而后者会根据条件进行判断，如果条件不满足，可能一次都不会执行循环。
一般情况下，最好使用 Do While|Until…Loop循环。 

12. 什么时候比较适合使用枚举？ 
答：如果需要将一组值中的一个存储在变量中，在使用过程中，用户只能进行选择，而不能自己指定值时，就可以使用枚举。
枚举可以有效地放置用户提供无效值，同时也能是变量的含义更清晰。 

13. 如何改变已经声明过的数组的长度？ 
答：要想改变数组中所容纳的元素的个数，可以使用ReDim关键字对数组进行重新定义。
需要注意的是，使用ReDim关键字，并不能改变数组的维数，而且默认情况下，数组中原来的元素值都会被清除，如果需要保留原来的元素值就需要在ReDim关键字后，添加Preserve关键字。 

14. 如何使方法可以接收，可变长度的参数？ 
答：为了使方法能够接收，可变数量的参数，可以在方法的参数列表处使用ParamArray关键字修饰指定类型的数组名称。
需要注意的是，如果使用ParamArray关键字的话，它只能放在所有确定参数的后面。 
例如，Add方法可以接收任意多个整数值，并进行求和。
代码如下： 
Function Add(ByVal ParamArray b() As Integer) As Integer 
Dim i As Integer = 0 
Dim Sum As Integer = 0 
For Each i In b 
Sum += i 
Next 
Return Sum 
End Function 
在具体调用时，就可以把任意多个整数值，通过逗号分隔开即可。
例如计算1,2,3三个数的和，就可以写为：Add（1,2,3）。 

15. 什么时候需要使用常量？ 
答：如果某一个值，在项目当中需要多次用到，在程序使用过程中并不需要修改，但是这个值本身有可能会需要修改，这是最好使用常量。既可以免去因修改不全而引发的错误，又可以增加程序的灵活性。
一般在使用常量时，会把常量进行全局定义。 

## 异常处理与调试

1. 如何知道编写的代码中存在语法错误？
答：如果在编写代码过程中存在语法错误，那么在出现错误的代码下面就会出现蓝色的波浪线，同时会在错误列表中出现错误的详细描述。

2. 存在语法错误的程序能运行吗？
答：存在语法错误的程序是不能运行的，如果代码在修改之前曾经成功编译过，但是在修改之后出现了语法错误，那么开发环境会给出提示“发生生成错误。是否继续并运行上次的成功生成？”如果选择“是”，那么会执行之前的编译结果，如果选择“否”，那么会终止运行，停留在代码编辑界面，这时，可以通过观察代码下方是否存在画蓝色波浪线的地方，或者观察“错误列表”都可以发现出现语法错误的位置。

3. 在编写代码中怎样才能减少语法错误的发生？
答：在编写代码过程中，为了避免发生语法错误，最好要结合使用开发环境提供的智能感知功能，如果已经声明过的变量或者已经添加到窗体中的控件，在编写代码时，不能在编写代码的过程中通过列表框进行显示，一般来说，可能会存在变量名或控件名拼写错误的问题；同样的对一个对象如果在键入“对象名.”后没有出现列有可选的方法和属性的列表框，那么一般情况也会存在问题。

4. 是否异常处理过程对所有的代码都是必须的？
答：一般来说，为了保证代码的健壮性都会需要编写适当的异常处理过程。但是并不是说所有的语句都要放在异常处理过程中，异常处理过程主要是针对那些很重要，一旦出现问题会影响程序正常执行的语句而言的。

5. 如何确定在异常处理过程中需要设置多少个Catch语句？
答：Catch语句的多少，主要取决于Try语句块中操作可能引发的异常的类型都包括哪些，这些异常类型的确定，可以通过查看相应方法调用的MSDN文档来获得，如果在确定的一些特定的异常类型之外，还不能保证不出现其他异常，或者说还可能出现什么样的异常并不能很确定时，可以在所有捕获特定类型异常的Catch语句的最后，添加一个捕获Exception类型异常的Catch语句，或者抛出一个新的异常。

6. Catch语句块可以为空吗？
答：可以。在这种情况下，异常将被忽略，生成错误的行后面的代码不会继续执行，如果没有Finally语句块，那么会跳出异常处理过程；如果有Finally语句块，那么会执行Finally语句块。

7. 设置和取消断点的最简单方法是什么？
答：设置断点的最简单方式就是在代码编辑器中，需要中断的代码行左侧的边框上单击鼠标左键，这时就会出现一个红色的圆点，表示已经添加了断点，如果想取消一个已经设置的断点，只需要在断点处再次单击鼠标左键，当红色圆点消失时，就表示断点已经被取消。

8. 什么时候需要进行代码调试？
答：一般情况下，如果已经知道程序的执行结果和预期结果不一致，但是又不能确定错误时在哪个执行步骤产生的，就可以对代码进行调试。

9. 代码调试对初学者有什么用处？
答：对初学者来说，可以通过代码调试的逐语句或者逐过程执行来掌握程序的调用顺序，加深对程序执行过程的理解。

10. 只要在代码中设置了断点，代码就会中断进入调试状态吗？
答：不是。如果代码需要在执行到断点后，进入调试状态，就需要保证没有修改编译配置。默认情况下编译配置为Debug，如果把Debug改为了Release，那么无论是否设置了断点，代码都不会中断执行，进入调试状态。 

## 窗体与控件

1. 如何同时改变窗体中控件的Text属性中显示文字的大小？
答：在设计窗体中，选中窗体，然后通过属性窗口对窗体的Font属性进行设置，这样，窗体中控件的Text文本大小都会随之发生变化，而不需要逐个控件去修改Font属性。

2. 我在项目中添加了另外一个窗体，并编写了一些代码，但是怎样才能运行后添加的这个窗体呢？
答：当项目中包含了多个窗体时，为了分别对每个窗体进行调试，就需要修改启动窗体，把需要调试的那个窗体作为启动窗体。具体的做法是：在“解决方案资源管理器”中选中项目，并单击右键，然后在弹出的菜单中选择“属性”选择，这是就会打开项目属性的Tab页面，在“应用程序”选项卡中，找到“启动窗体”，并根据需要在下拉列表框中选择需要启动的窗体。选中后，再次运行时，启动窗体就会改变了。

3. 如何让窗体在运行时是进行全屏显示？
答：通常情况下，窗体在运行后的大小与设计时是保持一致的，但是可以通过修改窗体的WindowState属性来改变窗体显示的情况。如果要全屏显示，其实就是将WindowState属性设置为Maximized。

4. 除了重新绘制窗体边框之外，有没有更简单的方法创建非矩形的窗体？
答：还有一种较为简单的方式来实现非矩形窗体，这种方式可以通过三个属性的设置就能实现。首先我们需要有一张可以作为背景的图片，这个图片上要包含所要显示窗体的形状，其他不需要显示出来的部分，需要用同一种颜色。例如，要显示一个圆形窗体，可以将圆形内部设置为蓝色，而圆形外部都是白色。有了这张图片后，就可以将它设置为窗体的BackGroundImage，然后将TransparencyKey属性设置为白色，并将FormBorderStyle属性设置为None，设置完毕后，再运行窗体，就会显示出圆形的窗体了。

5. TextBox控件和RichTextBox控件有和区别？
答：二者的区别主要体现在以下四方面：
  首先默认情况下TextBox控件只显示单行的文本，只有将MultiLine属性设置为True时，才能显示多行文本。而RichTextBox控件本身就是进行多行显示的。
  其次，二者能容纳的字符数不同，TextBox控件能容纳的字符数少，RichTextBox控件能容纳的字符数多。具体容纳的字符数可以通过MaxLength属性查看默认值。
  第三，RichTextBox控件可使用的方法更多，可以调用SaveFile方法或LoadFile方法对RTF类型的文本信息进行保存或加载。而TextBox控件没有这样的方法。
  最后，TextBox控件中文本的字体只能进行整体设置，而RichTextBox控件允许对部分文本的字体进行设置。

6. 所有的控件都具有键盘事件吗？
答：只有能够获得焦点的控件才具有键盘事件，其他不能获得焦点的控件是不能触发键盘事件的。例如，Label控件就不能获得焦点，所以它就不具有键盘事件，而只具有鼠标事件。

7. 怎样实现，在单击窗体关闭按钮时，不会关闭窗体？
答：如果要想在单击窗体关闭按钮时，不关闭窗体就需要对窗体的FormClosing事件编写事件处理过程，在此事件处理过程中的参数是System.Windows.Forms.FormClosingEventArgs类型的，它有一个Cancel属性，当该属性值为True时，就可以取消该事件的操作。在这里也可以添加一个消息对话框，让用户进行选择是否需要关闭，从而增强应用程序的用户体验。

8. 我要在列表框中实现双击一个条目后，该条目会从列表框中删除，并显示在其他控件中，为什么不能显示被删除的条目？
答：出现这个问题的主要原因是编写代码时，没有注意语句的顺序，先调用了列表框的Remove方法将选中的条目删除，然后再为其他控件的Text属性赋值造成的。最简单的解决办法就是将为其他控件的赋值语句放在列表框的Remove方法调用之前。也可以在删除被选中的条目之前，将该值赋值给一个变量，然后再将变量值赋给其他控件。

9. 如何在窗体最小化时只显示在系统任务栏的托盘区中？
答：为了实现这个功能，需要在窗体中添加NotifyIcon控件，并为其设置Icon属性，即选择要显示的.ico图标，并设置Text属性，以便鼠标停留在图标上时显示相关提示信息。如果想要实现在窗体加载时就显示在托盘区中，就可以在窗体的Load事件中添加Me.Hide()语句 ，并将NotifyIcon控件对象的Visible属性设置为True。为了在双击该图标后显示窗体就需要在NotifyIcon控件对象的DoubleClick事件处理过程中将NotifyIcon控件对象的Visible属性设置为False，和Me.Show()语句。

10. 如何知道控件的默认事件是什么呢？
答：要想知道控件的默认事件非常简单，只需要在窗体设计界面双击选定的控件，就会在代码编辑器中添加该控件对象的默认事件框架。

11. 如果从界面中删去某个控件，与此控件相关的默认事件处理过程会不会也自动删除？
答：不能。虽然创建控件对象的默认事件处理过程时，可以通过在控件上双击来添加事件处理过程与事件源的关联框架代码，但是这个过程是不可逆的，它不会随着控件的删除而删除，必须手动进行删除或者将其变为注释，否则，很容易引发错误。

12. 为什么我对OpenFileDialog对话框已经通过代码进行了属性设置，为什么显示的时候没有变化呢？
答：发生这样问题的主要原因是对OpenFileDialog对话框对象的属性设置语句放在了ShowDialog方法的后面了。只要将所有的属性设置语句前移到ShowDialog方法之前，就可以进行正常显示了。

13. KeyDown事件与KeyPress事件有什么区别？
答：首先，KeyDown事件和KeyPress事件的触发顺序和次数不同。KeyDown事件在某个键被按下时，只会触发一次，而且是先于KeyPress事件被触发；KeyPress事件会在KeyDown事件之后被触发，而且只要长时间按住一个键，就会被多次触发。其次，二者能够接收的键值不同。KeyDown事件可以接收任何一个键盘按键的值，而KeyPress事件只能接收具有ASCII码值的按键值。

14. 如果要实现在一个控件处于选中状态时能够对“回车”有响应，应该编写哪个事件过程？
答：如果要响应“回车”，最好的方式是编写该对象的KeyDown事件。在事件处理过成的框架下对System.Windows.Forms.KeyEventArgs类型的参数e的KeyCode属性进行判断是否等于Keys.Enter。如果满足条件再进行进一步处理。

15. 如何动态的向窗体中添加控件？
答：向窗体中动态添加控件的过程大致分为以下几步，下面以动态添加Button控件为例进行说明。添加的Button对象名为MyButton。
（1）声明并实例化所需类型的控件对象。
Dim MyButton As New Button
（2）对该控件对象进行属性设置，特别是显示的位置和大小。可以使用SetBounds方法直接完成大小和位置的设置。并添加到窗体控件集合中。
  Sub NewButton()
  MyButton.SetBounds(100, 100, 50, 50)
  MyButton.Text = "MyButton"
  Me.Controls.Add(MyButton)
  End Sub
（3）在需要显示控件的过程中，调用对控件的设置，并编写需要的事件处理过程，并与事件源进行关联。
  NewButton()
  AddHandler MyButton.Click, AddressOf MyButton_Click
MyButton_Click过程的代码如下：
  Private Sub MyButton_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
  MessageBox.Show("My Button")
  End Sub
在这里需要说明的就是在声明对象变量是也可以添加WithEvents关键字来声明，这时需要注意的是不能在第三步使用AddHandler和AddressOf语句将事件处理过程与事件源进行关联，而要采用Handles子句进行关联，或者通过代码编辑器上方的两个下拉列表框进行选择，自动建立这个关联的框架。 

## 面向对象技术

1. 重载和重写有什么区别？
答：重载与重写最重要的区别在于重载要求方法签名不同，而重写的方法签名是相同的。另外，重载在派生类中要使用Overloads关键字；重写在基类中要使用Mustoverride或Overridable关键字，在派生类中要使用Overrides关键字。

2. 类应该在什么位置创建？
答：根据实际的需要类可以放在任何位置，可以是窗体的类框架内，单独的模块文件内，也可以放在单独的文件中，如果需要创建类库也可以放在单独的项目中。

3. 怎样建立事件源与事件处理过程的关联？
答：可以通过两种方式建立这种关联。一种是使用WithEvents关键字声明对象，然后再使用Handles子句将事件处理过程与事件源相关联，这种关联是在设计时确定的；另外一种关联是使用AddHandler和AddressOf子句，要处理的对象事件放在AddHandler后面，对应的事件处理过程放在AddressOf后面，这种关联可在程序运行时，动态建立关联，较为灵活。

4. 与事件源相关联的事件处理过程的名称是否必须要与对象的事件名称保持一致？
答：这不是必须的。实际上只要使用了WithEvents，Handles子句；或者AddHandler，AddressOf子句就可以将任何名称的过程与事件源相关联，也就是说事件处理过程本身的名称并不重要。但是，为了增强可读性，一般在代码编辑器中，如果通过选择对象和事件的方式建立事件源于事件处理过程的关联时，就会自动保持名称的一致，把对象名称和事件名称中间通过下划线连接来作为事件处理过程的名称。

5. Visual Basic.NET中可以实现多继承吗？
答：不可以。Visual Basic.NET不支持多继承，任何一个类最多只能有一个父类。但是，可以通过接口来实现类似的功能。

6. 只要进行重载就需要添加Overloads关键字吗？
答：不是的。如果在某个类中有关于一个同名方法的重载时可以省略Overloads关键字，但是如果在其中一个重载方法中添加了Overloads关键字，那么其他的重载方法也必须添加Overloads关键字。但是，如果在派生类中重载了基类中的方法时，必须添加Overloads关键字。

7. 如何在派生类中调用基类中的方法？
答：要想在派生类中调用基类中的方法，就需要使用MyBase关键字。通过“MyBase.”加对应的方法名称及所需参数即可。

8. 如果函数过程只是返回值类型不同，能够进行重载吗？
答：不能。方法能否被重载只取决于参数的类型、数量和顺序上是否存在差异。如果存在不同，就可以进行重载；否则，不可以进行重载。它与是否方法具有返回值毫无关系，所以仅仅依靠返回值类型的不同来进行重载是不能实现的。

9. 哪种实现多态的方式相对而言不是很理想，最好少用？
答：相对而言，后期绑定的方式实现多态的性能会差一些，因为它需要在执行过程中将Object类型的对象转换为特定的类型对象，会多消耗时间；另外如果在执行过程中指定的对象并不是有效的对象时，就会发生异常。因此，如果有其他的替代方法，最好不要采用后期绑定的方式实现多态。

10. 为了共享某个类的某些方法、属性或事件，就可以使用继承吗？
答：不一定。是否使用继承与两个类的关系有关。如果其中一个类是另一个类的进一步的特殊化或者说一个类可以作为另一个类的子类，在原有类的继承上又有了自己的一些不同之处时，可以使用继承来共享某些方法、属性或事件。如果不满足这个关系，又想进行共享的话，最好采用接口来实现。 

## 文件

1. 如何确定文件是否存在？
答：可以调用System.IO.File.Exists()方法进行确定，如果文件存在，那么返回True，否则返回False。

2. 如果不想永久性的删除文件，应该怎样做？
答：可以将文件发送到“回收站”即可。例如要将D盘根目录下的名为“First”的文本文件发送到“回收站”就可以使用下面的语句：
My.Computer.FileSystem.DeleteFile(“D:\First.txt”, _
FileIO.UIOption.AllDialogs, FileIO.RecycleOption.SendToRecycleBin)
其中DeleteFile方法中的第一个参数就是待删除的文件，第二个参数是删除时弹出的对话框设置，第三个参数就是用来将文本发送到“回收站”的选项。
3. 文本文件与二进制文件有何区别？
答：最直观的区别在于文本文件是可以简单的通过记事本打开就可以看到里面的内容是什么，而二进制文件对于一般的用户来说，可能看到的就像乱码一样，并不能完全看出文件里存储的文字信息。这主要在于文本文件存储的是ASCII码，在记事本中会每八位“0”和“1”序列（一个字节）转换成对应的字符；而二进制文件存储的 “0”和“1”序列所包含的信息并不一定完全是按照字节（每八位为一组）进行分组的，所以通过记事本显示时可能会因为数据信息划分转换的位数的差错而不能正确显示信息，从而给人的感觉好像是乱码。

4. 为什么我存储的文件，通过记事本打开时显示的是乱码？
答：这可能是因为，在进行文件存储的时候并不是以文本文件的形式存储的，而是以二进制文件的形式进行存储的，而这些有效信息的划分也并不是以字节为单位的，这就会造成显示的单位信息与实际的单位信息不一致，给人感觉就像乱码一样，不具有可读性。

5. 任何TXT文件都能在我的程序中正确加载吗？
答：不一定。一般来说如果TXT文档是直接在记事本中编写的，并且该文档中含有中文字符，那么在应用程序中如果打算通过TextBox或者RichTextBox加载时，中文字符很可能不能进行正常显示。所以为了保证TXT文档中的汉字能够在程序的相关控件中正确显示，最好的方法就是先通过StreamWriter类的对象对文件进行写入，这之后即使只在记事本中对文档编辑，在程序中都能够正确显示，而不会出现乱码现象。

6. 如何判断文件是否读取完毕？
答：可以通过StreamReader对象的Peek方法进行判断，如果Peek方法的返回值不为“-1”，那么表示文件还没有读取到文件末尾；如果Peek方法的返回值为“-1”，就表示文件读取结束。

7. 如何保证写入文件的字符串中所含的字符数是固定值？
答：为了保证写入文件的字符串的字符数为固定值，需要在写入文件前进行预处理，主要操作是将字符串转化为字符数组，这样可以通过字符数组的长度来控制写入字符串的长度。通常为了完成这种转换，需要调用字符串的CopyTo方法。

8. 什么时候使用StreamReader对象对文件读取较为合适？
答：当文件中所包含的信息都是字符串信息时，使用StreamReader对象进行读取较为合适。
9. 什么时候使用BinaryReader对象对文件读取较为合适？
答：当文档的数据中包含有非字符串信息时，使用BinaryReader对象进行读取较为合适。这时需要明确每个字段的类型和长度，要保证使用BinaryReader对象读取时，调用的方法与这些字段的类型和长度是匹配的。

10. 如果使用StreamReader对象如何保证能像记录一样，把一行数据划分成多个字段？
答：首先要保证文档中的每行数据所包含的多个字段都是用相同的分隔符进行分隔的，最常用的分隔符就是逗号。在采用StreamReader进行读取数据时先调用ReadLine方法；然后调用Split方法，对得到的一行字符串进行分割，并使用字符串数组来接收Split方法分割得到的各个字段。如果需要的话，可以对某些数组元素进行类型转换。 

## 数据库技术

1. 在使用VB.NET访问数据库时，是否必须使用DataSet来把数据库中的数据加载到内存中？
答：不一定。这主要看需要进行哪些操作。一般来说，如果只是想简单的浏览数据，而且操作并不复杂，也不需要多次使用同一条记录的话，就可以不使用DataSet而只是使用DataReader进行读取即可。

2. OLE DB.NET数据提供程序和普通的OLE DB提供程序是一回事吗？
答：不是的。OLE DB.NET数据提供程序会连接特定的OLE DB提供程序，来访问具体的数据源。

3. 怎样选择数据提供程序更合理？
答：把特定数据库的.NET数据提供程序作为首选，如果没有，就可以选择.NET OLE DB数据提供程序，如果还没有的话，就只能选用.NET ODBC数据提供程序。

4. 怎样才能保证用于建立与数据库连接的连接字符串的正确性？
答：一般来说，访问的数据库不同，需要使用不同的数据提供者，这也决定了不同的连接对象的连接字符串的格式是不完全一致的。因此在刚刚接触数据库编程时，想要同时记住不同的连接字符串的格式，即不容易，也没有太多的必要。其实，只要了解每个字符串中的关键字的含义即可，可以通过创建连接向导的提示，逐步进行选择和设置，这样就会自动产生正确的连接字符串。这时需要做的就是把这个自动产生的连接字符串保存到一个文件中即可，在用的时候，可以根据需要进行适当的修改。

5. 为什么需要使用存储过程？
答：使用存储过程主要有两点好处：首先，可以提前编译，所以执行速度比较快。其次，也可以对安全性有一定的保证，可以避免因SQL语句注入而引发的安全性问题。

6. 为什么在DataAdapter对象中使用了多个参数，但是却不能正确的更新数据库中的数据，或者运行时出现错误呢？
答：出现错误的原因主要来自两个方面：（1）添加参数的类型不正确。（2）添加参数的顺序不正确。为了避免发生错误，一定要在编写代码的过程中多加留意，保证参数的类型与数据库中对应字段类型保持一致，并且参数添加的顺序要与相关的SQL语句中的对应参数顺序保持一致。

7. 要访问SQL Server数据库时，是否只能采用SQL Server的数据提供程序？
答：不是。这主要看看SQL Server的版本。如果该版本是SQL Server7.0及以上时，需要使用SQL Server.NET的数据提供程序，如果版本较低则需要采用OLE DB.NET数据提供程序。但是，目前来说主流的SQL Server数据库版本，都会采用SQL Server.NET的数据提供程序。

8. Command对象的ExecuteNonQuery、ExecuteScalar和ExecuteReader方法的适用场合有何区别？
答：简单的说ExecuteNonQuery方法适用于删除、更新、插入等需要对数据库中数据表的内容有改动的操作；ExecuteScalar方法适用于需要给应用程序返回一个确定结果的操作时使用，一般情况下并不会改变数据库中数据表的内容；ExecuteReader方法适用于应用程序要得到的数据中同时包含数据表中的多个字段，这种操作也不会改变数据库总数据表的内容。

9. “？”占位符和“@”占位符使用时有何区别？
答：“？”占位符是OLE DB.NET数据提供程序所使用的占位符，通常一个“？”占位符就可以表示一个参数；“@”占位符通常是SQL Server数据提供程序所使用的占位符，一个“@”占位符并不能表示一个参数，而只能作为参数的开头字符。

10. 使用Visual Basic.NET访问数据库的一般操作过程是怎样的？
答：使用Visual Basic.NET访问数据库一般分为以下几个步骤：
（1）确定使用的数据提供程序。然后通过该数据提供程序的Connection对象与要访问的数据库建立连接。
（2）打开数据库并根据操作的需要选择Command对象直接执行相关操作（不需要对同一条记录进行多次操作时选用）。或者通过DataAdapter填充DataSet，然后再根据Command对象参数执行相关操作。
（3）断开与数据库的连接。采用DataSet时，通常在填充完DataSet后就需要断开与数据库的连接，然后再在本地执行一些相关操作。

11. 如何在设计时实现控件与数据源的绑定？
答：实现控件与数据源的绑定的最简单方式就是通过在数据源窗口中，选择所需的数据表，将其直接拖拽到窗体上，或者自定义设置数据表中字段的显示形式，都可以自动实现绑定。另外也可以手动的创建绑定：在控件的DataBindings属性中的Advanced属性中选择需要绑定的字段。

12. 为什么通过拖拽自动产生的控件与数据的绑定在程序运行时，明明已经对数据进行了修改，为什么再次运行时，数据又回到了修改之前的内容呢？
答：这是因为在自动生成的代码中并不包括数据库更新的操作语句，只是对DataSet中的数据进行操作。程序一旦结束，再次运行时，又会重新加载数据库中的数据，所以就看不到数据的变化了。为了实现数据库也进行更新，就需要手动添加一些DataAdapter对象的参数来辅助实现数据库的更新。

13. 如何通过编写代码向DataGridView控件中添加一条记录？
答：如果DataGridView控件没有与数据源进行绑定可以调用Rows的Add方法来添加一行信息，一行信息的多列可以由逗号进行分隔；如果已经与数据源进行了绑定就需要调用DataSet中的数据表添加行调用Add*Row方法。其中“*”可用具体的数据表名称代替。 

# 语法规则

## 基本数据类型

| 类型 | 类型名称 | 占内存字节数 |
|:----:|:----:|:----:|
| Boolean | Boolean | 2 |
| Byte | Byte | 1 |
| Char | Char | 2 |
| Date | DateTime | 8 |
| Decimal | Decimal | 16 |
| Double | Double | 8 |
| Integer | Int32 | 4 |
| Long | Int64 | 8 |
| Object | Object | 4(32位平台) / 8(64位平台) |
| SByte | SByte | 1 |
| Short | Int16 | 2 |
| Single | Single | 4 |
| String | String | 不定长 |
| UInteger | UInt32 | 8 |
| ULong | UInt64 | 4 |
| UShort | UInt16 | 2 |

隐式类型转换方向：Byte → Short → Integer → Long → Decimal → Single → Double

| 数据类型 | 类型字符 | 类型符号 |
|:----:|:----:|:----:|
| Short | S |  |
| Integer | I | % |
| Long | L | & |
| Decimal | D | @ |
| Single | F | ! |
| Double | R | # |
| UShort | US |  |
| UInteger | UI |  |
| ULong | UL |  |
| Char | C |  |
| String |  | $ |

# Quiz

- [Quiz1](https://blankspace.blog.csdn.net/article/details/103226993)
- [Quiz2](https://blankspace.blog.csdn.net/article/details/103226993)
- [Quiz3](https://blankspace.blog.csdn.net/article/details/103226993)
- [Quiz4](https://blankspace.blog.csdn.net/article/details/103226993)

# 编程训练

## 字符串数组排序

```vbnet
Public Class Form1
    '声明一个包含6个元素的字符串数组Student
    Dim Student(5) As String
    Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        '对数组元素赋值
        Dim i As Integer
        Student(0) = "张三"
        Student(1) = "王刚"
        Student(2) = "李想"
        Student(3) = "李华"
        Student(4) = "陈晨" : Student(5) = "钱进"
        '在文本框中进行分行显示，每个元素占一行。vbCrLf：回车换行
        For i = 0 To 5
            TextBox1.Text &= Student(i) & vbCrLf
        Next
    End Sub

    Private Sub btnSort_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSort.Click
        '对数组进行排序
        Dim a As String
        Array.Sort(Student)
        '在文本框中显示排序后的元素
        For Each a In Student
            TextBox2.Text &= a & vbCrLf
        Next
    End Sub
End Class
```

排序前：
![](../../../images/软件开发/VB.NET/VB.NET程序设计学习指南/1.png)

排序后：
![](../../../images/软件开发/VB.NET/VB.NET程序设计学习指南/2.png)

## 窗体方法

4种窗体方法
- Show：
  用来显示窗体。如果窗体已经加载到内存，就直接显示；如果没有，那么就先加载再显示。
  如果一个窗体被叠放在其它窗体之下，本方法可以将该窗体移到屏幕的最上层。
  调用此方法与设置Visiable属性为True等效。
- Hide：
  与Show相对，用它来使得窗体在屏幕上不可见，但该窗体还在内存里。
  如果说一个窗体需要被多次调用，就可以使用此方法，在暂时不需要其时隐藏。这样做可以提高效率但是会占用内存空间。
  调用此方法与设置Visiable属性为False等效。
- Close：
  用来关闭窗体。
  当窗体被关闭后，将不再占用内存。
- SetBounds：
  用来指定窗体的位置和大小。
  包含4个参数——X坐标、Y坐标、窗体的宽度以及窗体的高度。

核心代码：

```vbnet
Public Class Form1
    Dim frm2 As New Form2

    Private Sub btnClose_Click(sender As Object, e As EventArgs) Handles btnClose.Click
        frm2.Close()
    End Sub

    Private Sub btnHide_Click(sender As Object, e As EventArgs) Handles btnHide.Click
        frm2.Hide()
    End Sub

    Private Sub btnShow_Click(sender As Object, e As EventArgs) Handles btnShow.Click
        frm2.Show()
    End Sub

    Private Sub btnSetBounds_Click(sender As Object, e As EventArgs) Handles btnSetBounds.Click
        frm2.SetBounds(200, 200, 50, 50)
    End Sub
End Class

```

实现效果：

![](../../../images/软件开发/VB.NET/VB.NET程序设计学习指南/3.png)

![](../../../images/软件开发/VB.NET/VB.NET程序设计学习指南/4.png)

![](../../../images/软件开发/VB.NET/VB.NET程序设计学习指南/5.png)

下图的情况是在Close以后对Show调用报错。
![](../../../images/软件开发/VB.NET/VB.NET程序设计学习指南/6.png)

## 星座判断

```vbnet
    Private Sub Form4_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Dim month(11) As Object
        Dim day(30) As Object
        For i = 0 To 30
            If i < 12 Then
                month(i) = i + 1
            End If
            day(i) = i + 1
        Next
        ComboBox1.Items.AddRange(month)
        ComboBox2.Items.AddRange(day)
    End Sub
 
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim a As Integer
        Dim b As Integer
        a = ComboBox1.SelectedItem
        b = ComboBox2.SelectedItem
        If a = 1 Then
            If b > 0 & b <= 20 Then
                Label1.Text = "魔蝎"
            Else
                Label1.Text = "水瓶"
            End If
        End If
        If a = 2 Then
            If b > 0 & b <= 19 Then
                Label1.Text = "水瓶"
            Else
                Label1.Text = "双鱼"
            End If
        End If
        If a = 3 Then
            If b > 0 & b <= 20 Then
                Label1.Text = "双鱼"
            Else
                Label1.Text = "白羊"
            End If
        End If
        If a = 4 Then
            If b > 0 & b <= 20 Then
                Label1.Text = "白羊"
            Else
                Label1.Text = "金牛"
            End If
        End If
        If a = 5 Then
            If b > 0 & b <= 21 Then
                Label1.Text = "金牛"
            Else
                Label1.Text = "双子"
            End If
        End If
        If a = 6 Then
            If b > 0 & b <= 21 Then
                Label1.Text = "双子"
            Else
                Label1.Text = "巨蟹"
            End If
        End If
        If a = 7 Then
            If b > 0 & b <= 22 Then
                Label1.Text = "魔蝎"
            Else
                Label1.Text = "水瓶"
            End If
        End If
        If a = 8 Then
            If b > 0 & b <= 23 Then
                Label1.Text = "狮子"
            Else
                Label1.Text = "处女"
            End If
        End If
        If a = 9 Then
            If b > 0 & b <= 23 Then
                Label1.Text = "处女"
            Else
                Label1.Text = "天秤"
            End If
        End If
        If a = 10 Then
            If b > 0 & b <= 23 Then
                Label1.Text = "天秤"
            Else
                Label1.Text = "天蝎"
            End If
        End If
        If a = 11 Then
            If b > 0 & b <= 23 Then
                Label1.Text = "天蝎"
            Else
                Label1.Text = "射手"
            End If
        End If
        If a = 12 Then
            If b > 0 & b <= 23 Then
                Label1.Text = "射手"
            Else
                Label1.Text = "水瓶"
            End If
        End If
    End Sub
```

# 慕课资源

- [TONGJI -《VisualBasic.NET程序设计入门》](http://www.icourse163.org/course/TONGJI-370002)
- [TONGJI -《VisualBasic.NET程序设计进阶》](http://www.icourse163.org/course/TONGJI-371001)

# 课程实验

- [VB.NET控件综合运用](https://blankspace.blog.csdn.net/article/details/104415378)
- [VB.NET个人信息管理系统](https://blankspace.blog.csdn.net/article/details/104416094)

# 学习资料
- [.NET复习总结](https://wzlodq.blog.csdn.net/article/details/108422569)
